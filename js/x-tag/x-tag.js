(function(){function r(t,n){n&&l.tagList.length&&t.childNodes.length&&l.query(t,l.tagList).forEach(function(e){r(e)}),l.tagCheck(t)&&(l.extendElement(t),e.documentElement.contains(t)&&l.getOptions(t).onInsert.call(t))}function o(e,t,n){switch(l.typeOf(n)){case"object":l.typeOf(e[t])=="object"?l.merge(e[t],n):e[t]=l.clone(n);break;case"array":e[t]=l.toArray(n);break;default:e[t]=n}return e}function p(){l.observe(e.documentElement,r),l.tagList.length&&l.query(e,l.tagList).forEach(function(e){r(e)}),l.domready=!0,l.fireEvent(e,"DOMComponentsLoaded"),l.fireEvent(e,"__DOMComponentsLoaded__")}var e=document,t=window,n=e.getElementsByTagName("head")[0],s=function(){var n=t.getComputedStyle(e.documentElement,""),r=(Array.prototype.slice.call(n).join("").match(/-(moz|webkit|ms)-/)||n.OLink===""&&["","o"])[1],i="WebKit|Moz|MS|O".match(new RegExp("("+r+")","i"))[1];return{dom:i,lowercase:r,css:"-"+r+"-",js:r!="ms"?r[0].toUpperCase()+r.substr(1):"ms"}}(),u={listener:function(e,t,n){!!~e.value.match(/(\d+)/g).indexOf(String(n[0].keyCode))==(e.name=="keypass")&&(n.splice(n.length,0,this),t.apply(this,n))}},a={mouseenter:"touchenter",mouseleave:"touchleave",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend",click:"touchend"},f=function(e){var n=e=="over";return{base:"OverflowEvent"in t?"overflowchanged":e+"flow",condition:function(t){return t.type==e+"flow"||t.orient==0&&t.horizontalOverflow==n||t.orient==1&&t.verticalOverflow==n||t.orient==2&&t.horizontalOverflow==n&&t.verticalOverflow==n}}},l={tags:{},tagList:[],callbacks:{},prefix:s,anchor:e.createElement("a"),mutation:t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver,_matchSelector:e.documentElement.matchesSelector||e.documentElement.mozMatchesSelector||e.documentElement.webkitMatchesSelector,_register:e.register,tagOptions:{content:null,mixins:[],events:{},methods:{},getters:{},setters:{},onCreate:function(){},onUpgrade:function(){},onInsert:function(){}},customEvents:{animationstart:{base:["animationstart","oAnimationStart","MSAnimationStart","webkitAnimationStart"]},transitionend:{base:["transitionend","oTransitionEnd","MSTransitionEnd","webkitTransitionEnd"]},overflow:f("over"),underflow:f("under")},pseudos:{delegate:{listener:function(e,t,n){var r=l.query(this,e.value).filter(function(e){return e==n[0].target||e.contains?e.contains(n[0].target):!1})[0];return r?t.apply(r,n):!1}},preventable:{listener:function(e,t,n){n[0].defaultPrevented||t.apply(this,n)}},attribute:{onAdd:function(e){this.xtag.attributeSetters=this.xtag.attributeSetters||{},e.value=e.value||e.key.split(":")[0],this.xtag.attributeSetters[e.value]=e.key.split(":")[0]},listener:function(e,t,n){t.call(this,n[0]),this.setAttribute(e.value,n[0],!0)}},touch:{onAdd:function(e,t){this.addEventListener(a[e.key.split(":")[0]],t,!1)},listener:function(e,t,n){t.touched?t.touched=!1:(n[0].type.match("touch")&&(t.touched=!0),n.splice(n.length,0,this),t.apply(this,n))},onRemove:function(e,t){this.removeEventListener(a[e.key.split(":")[0]],t)}},keystop:u,keypass:u},mixins:{request:{getters:{src:function(){return this.getAttribute("src")},dataready:function(){return this.xtag.dataready}},setters:{"src:attribute":function(e){e&&l.request(this,{url:e,method:"GET"})},dataready:function(e){this.xtag.dataready=e,this.xtag.request&&this.xtag.request.readyState==4&&e.call(this,this.xtag.request)}}}},typeOf:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},toArray:function(e){var t=Array.prototype.slice.call(e,0);return["number","string","function"].indexOf(typeof e)==-1?t:[e]},hasClass:function(e,t){return!!~e.className.split(" ").indexOf(t)},addClass:function(e,t){if(!l.hasClass(e,t)){var n=e.className.split(" ").filter(function(e){return e!=""});n.push(t),e.className=n.join(" ")}return e},removeClass:function(e,t){var n=e.className.split(" ").filter(function(e){return e!=""}),r=n.indexOf(t);return r>=0&&n.splice(r,1),e.className=n.join(" "),e},toggleClass:function(e,t){return l.hasClass(e,t)?l.removeClass(e,t):l.addClass(e,t)},matchSelector:function(e,t){return l._matchSelector.call(e,t)},query:function(e,t){return l.toArray(e.querySelectorAll(t))},queryChildren:function(e,t){var n=null,r="x-"+(new Date).getTime(),i='[xtag-temp-id="'+r+'"] > ',t=i+(t+"").replace(",",","+i,"g");return e.setAttribute("xtag-temp-id",r),n=e.parentNode.querySelectorAll(t),e.removeAttribute("xtag-temp-id"),l.toArray(n)},defineProperty:function(t,n,r,i){return e.documentElement.__defineGetter__?function(e,t,n,r){e["__define"+n[0].toUpperCase()+"etter__"](t,r)}:function(e,t,n,r){var i={configurable:!0};i[n]=r,Object.defineProperty(e,t,i)}}(),clone:function(e){var t=function(){};return t.prototype=e,new t},merge:function(e,t,n){if(l.typeOf(t)=="string")return o(e,t,n);for(var r=1,i=arguments.length;r<i;r++){var s=arguments[r];for(var u in s)o(e,u,s[u])}return e},wrap:function(e,t){return function(){var n=l.toArray(arguments);e.apply(this,n),t.apply(this,n)}},skipTransition:function(e,t,n){var r=s.js+"TransitionDuration";e.style[r]="0.001s",t.call(n),l.addEvent(e,"transitionend",function(){e.style[r]=""})},tagCheck:function(e){return e.nodeName?l.tags[e.nodeName.toLowerCase()]:!1},getOptions:function(e){return l.tagCheck(e)||l.tagOptions},register:function(t,n){l.tagList.push(t),l.tags[t]=l.merge({tagName:t},l.tagOptions,l.applyMixins(n||{})),l.domready&&l.query(e,t).forEach(function(e){r(e)})},extendElement:function(e){if(!e.xtag&&l.tagCheck(e)){e.xtag={};var t=l.getOptions(e);for(var n in t.methods)l.bindMethod(e,n,t.methods[n]);for(var n in t.setters)l.applyAccessor(e,n,"set",t.setters[n]);for(var n in t.getters)l.applyAccessor(e,n,"get",t.getters[n]);l.addEvents(e,t.events),t.content&&l.insertContent(e,t.content),t.onCreate.call(e),t.onUpgrade.call(e),l._register||l.fireEvent(e,"elementupgrade")}},insertContent:function(e,t){var n=document.createDocumentFragment(),r=document.createElement("div");n.appendChild(r),r.innerHTML=t;var i=l.query(r,"content");if(i.length==0){e.innerHTML=t;return}var s=i.map(function(e){return e.getAttribute("select")});l.toArray(e.children).forEach(function(e){for(var t=0;t<s.length;t++){var n=s[t];if(n&&l.matchSelector(e,n)){i[t].parentNode.insertBefore(e,i[t]);return}if(!n){i[t].parentNode.insertBefore(e,i[t]);return}}e.parentNode.removeChild(e)}),i.forEach(function(e){e.parentNode.removeChild(e)}),l.toArray(r.children).forEach(function(t){e.appendChild(t)})},innerHTML:function(e,t){e.innerHTML=t,l.observer?l.parseMutations(l.observer.takeRecords(),r):r(e)},bindMethod:function(e,t,n){e[t]=function(){return n.apply(e,l.toArray(arguments))}},applyMixins:function(e){return e.mixins&&e.mixins.forEach(function(t){var n=l.mixins[t];for(var r in n)switch(l.typeOf(n[r])){case"function":e[r]=e[r]?l.wrap(e[r],n[r]):n[r];break;case"object":e[r]=l.merge({},n[r],e[r]);break;default:e[r]=n[r]}}),e},applyAccessor:function(e,t,n,r){l.defineProperty(e,t.split(":")[0],n,l.applyPseudos(e,t,r))},applyPseudos:function(e,t,n){var r=n,i={};if(t.match(":")){var s=t.match(/(\w+(?:\([^\)]+\))?)/g);for(var o=s.length-1;o>0;o--)s[o].replace(/(\w*)(?:\(([^\)]*)\))?/,function(n,s,o){var u=r,a=l.pseudos[s],f={key:t,name:s,value:o};if(!a)throw"pseudo not found: "+s;a.onAdd&&(i[s]=f),r=function(t){t&&(t.customElement=e);var n=l.toArray(arguments);return n[1]=e,a.listener.apply(this,[f,u,n])}});for(var u in i)l.pseudos[u].onAdd.call(e,i[u],r)}return r},removePseudos:function(e,t,n){t.match(":")&&t.replace(/:(\w*)(?:\(([^\)]*)\))?/g,function(n,r,i){var s=action,o=l.pseudos[r],u={key:t,name:r,value:i};o.onRemove&&o.onRemove.call(e,u,s)})},request:function(r,i){l.clearRequest(r);var s=r.xtag.request||{};r.xtag.request=i;var o=r.xtag.request,u=r.getAttribute("callback-key")||"callback=xtag.callbacks.";if(l.fireEvent(r,"beforerequest")===!1)return!1;if(s.url&&!i.update&&s.url.replace(new RegExp("&?("+u+"x[0-9]+)"),"")==r.xtag.request.url)return r.xtag.request=s,!1;r.setAttribute("src",r.xtag.request.url),l.anchor.href=i.url[0]=="/"?t.location.protocol+"//"+t.location.hostname+i.url:i.url;if(l.anchor.hostname==t.location.hostname)o=l.merge(new XMLHttpRequest,o),o.onreadystatechange=function(){r.setAttribute("readystate",o.readyState),o.readyState==4&&o.status<400&&l.requestCallback(r,o)},["error","abort","load"].forEach(function(e){o["on"+e]=function(t){t.request=o,l.fireEvent(r,e,t)}}),o.open(o.method,o.url,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send();else{var a=o.callbackID="x"+(new Date).getTime();r.setAttribute("readystate",o.readyState=0),l.callbacks[a]=function(e){o.status=200,o.readyState=4,o.responseText=e,l.requestCallback(r,o),delete l.callbacks[a],l.clearRequest(r)},o.script=e.createElement("script"),o.script.type="text/javascript",o.script.src=i.url=i.url+(~i.url.indexOf("?")?"&":"?")+u+a,o.script.onerror=function(e){r.setAttribute("readystate",o.readyState=4),r.setAttribute("requeststatus",o.status=400),l.fireEvent(r,"error",e)},n.appendChild(o.script)}r.xtag.request=o},requestCallback:function(e,t){if(t!=e.xtag.request)return l;e.setAttribute("readystate",t.readyState),e.setAttribute("requeststatus",t.status),l.fireEvent(e,"dataready",{request:t}),e.dataready&&e.dataready.call(e,t)},clearRequest:function(e){var t=e.xtag.request;if(!t)return l;t.script&&~l.toArray(n.children).indexOf(t.script)?n.removeChild(t.script):t.abort&&t.abort()},parseEvent:function(e){var t=e.split(":"),n=t.shift(),r=l.merge({base:n,pseudos:"",onAdd:function(){},onRemove:function(){},condition:function(){}},l.customEvents[n]||{});return r.type=n+(r.pseudos.length?":"+r.pseudos:"")+(t.length?":"+t.join(":"):""),r},addEvent:function(e,t,n){var r=l.parseEvent(t),i=l.applyPseudos(e,r.type,n),s=function(){var e=l.toArray(arguments);return r.condition.apply(this,e)===!1?!1:i.apply(this,e)};return r.onAdd.call(e,r,s),l.toArray(r.base).forEach(function(t){e.addEventListener(t,s,!!~["focus","blur"].indexOf(t))}),s},addEvents:function(e,t){for(var n in t)l.addEvent(e,n,t[n])},removeEvent:function(e,t,n){var r=l.parseEvent(t);r.onRemove.call(e,r,n),l.removePseudos(e,r.type,n),l.toArray(r.base).forEach(function(t){e.removeEventListener(t,n)})},fireEvent:function(t,n,r,i){var i=i||{},s=e.createEvent("Event");s.initEvent(n,"bubbles"in i?i.bubbles:!0,"cancelable"in i?i.cancelable:!0),t.dispatchEvent(l.merge(s,r))},parseMutations:function(e,t){var n=[];e.forEach(function(e){var r=e.addedNodes,s=r.length;for(i=0;i<s&&n.indexOf(r[i])==-1;i++)n.push(r[i]),t(r[i],!0)})},observe:function(e,t){if(l.mutation){var n=new l.mutation(function(e){l.parseMutations(e,t)});n.observe(e,{subtree:!0,childList:!0,attributes:!1,characterData:!1}),l.observer=n}else e.addEventListener("DOMNodeInserted",function(e){t(e.target,!0)},!1)}},c=HTMLElement.prototype.setAttribute;(t.HTMLUnknownElement||HTMLElement).prototype.setAttribute=function(e,t,n){!n&&this.xtag&&this.xtag.attributeSetters&&(this[this.xtag.attributeSetters[e]]=t),c.call(this,e,t)};var h=e.createElement;e.createElement=function(e){var t=h.call(this,e);return l.extendElement(t),t},e.readyState=="complete"?p():e.readyState=="interactive"?e.addEventListener("readystatechange",function(e){p()}):e.addEventListener("DOMContentLoaded",function(e){p()},!1),typeof define=="function"&&define.amd?define([],l):t.xtag=l})()